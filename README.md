# ミニクロ

Excel ファイルにまとめた **年 / 範囲 / 出来事** のデータを読み込み、**縦スクロール型の年表** としてブラウザ上に表示し、A4 横向き PDF へエクスポートできる Web アプリです。

## 機能

- **Excel ファイル読み込み**: .xlsx ファイルをドラッグ & ドロップで読み込み
- **年表可視化**: 点イベント（円）と期間イベント（縦バー）を表示
- **PDF エクスポート**: A4 横向きサイズで高画質な PDF を生成
- **レスポンシブ対応**: 画面幅に応じて最適化
- **年間高さ調整**: イベントの表示高さを動的に調整

## セットアップ

### 前提条件

- Node.js 18.0.0 以上
- npm または yarn

### インストール

```bash
# リポジトリをクローン
git clone <repository-url>
cd timeline-visualizer

# 依存関係をインストール
npm install
```

### 開発サーバーの起動

```bash
# 開発サーバーを起動
npm run dev
```

ブラウザで [http://localhost:3000](http://localhost:3000) を開いてアプリケーションを確認できます。

### 動作確認

1. **Excel ファイルの読み込み**

   - Excel ファイル（.xlsx）をドラッグ & ドロップ
   - またはファイル選択ボタンをクリックしてファイルを選択

2. **PDF エクスポート**

   - データを読み込んだ後、「PDF エクスポート」ボタンをクリック
   - A4 横向きサイズの高画質 PDF がダウンロードされます

3. **年間高さ調整**
   - ヘッダーのスライダーで年間の表示高さを調整
   - 8px から 120px まで調整可能

## ビルド

```bash
# 本番用ビルド
npm run build

# 本番サーバーを起動
npm start
```

## テスト

```bash
# テストを実行
npm test

# テストカバレッジを確認
npm run test:coverage

# テスト UI を起動
npm run test:ui
```

## デプロイ

### Vercel へのデプロイ

1. [Vercel](https://vercel.com) にアカウントを作成
2. GitHub リポジトリを接続
3. `git push` で自動デプロイ

### 手動デプロイ

```bash
# ビルド
npm run build

# デプロイ（Vercel CLI を使用）
vercel --prod
```

## データ形式

### Excel ファイル形式

| 列  | 内容               | 必須 |
| --- | ------------------ | ---- |
| A   | 年（開始年）       | ✔    |
| B   | いつまで（終了年） | 〃   |
| C   | 出来事             | ✔    |

**注意事項:**

- 最大 5 つのシート（レーン）まで対応
- 各シートが 1 つのレーンとして表示されます
- 年は数値形式で入力してください

## 技術スタック

- **フレームワーク**: Next.js 15
- **UI**: Material-UI (MUI)
- **可視化**: d3-scale
- **ファイル解析**: xlsx
- **PDF 生成**: html2canvas, jsPDF
- **テスト**: Vitest, React Testing Library
- **言語**: TypeScript

## トラブルシューティング

### よくある問題

1. **Excel ファイルが読み込めない**

   - ファイル形式が .xlsx であることを確認
   - 必須列（年、出来事）が存在することを確認
   - 最大 5 つのシートまで対応していることを確認

2. **PDF エクスポートが失敗する**

   - ブラウザのポップアップブロッカーを無効化
   - 十分なメモリがあることを確認
   - 大きな年表の場合は処理に時間がかかる場合があります

3. **年表が正しく表示されない**
   - 年代軸の幅が十分であることを確認
   - 年間高さを調整して見やすくしてください

## 更新履歴

- v0.1.0: 初期リリース
  - Excel ファイル読み込み
  - 年表可視化
  - PDF エクスポート（A4 横向き）
  - 年間高さ調整機能
  - 高画質 PDF 生成
  - レスポンシブ対応
